<!doctype html>
<html data-n-head-ssr prefix="og: http://ogp.me/ns#" data-n-head="prefix">
  <head>
    <title>AWS ALB のメンテナンス閉塞をShellスクリプト化した - ZODIAC BLOG</title><meta data-n-head="ssr" data-hid="description" name="description" content="技術ブログ"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="ZODIAC BLOG"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="https://avatars1.githubusercontent.com/u/12181838?s=460&av=4"><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https:zodiac-G12.github.io/blog/2019-09-20"><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="programming"><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="ZODIAC BLOG - AWS ALB のメンテナンス閉塞をShellスクリプト化した"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/blog/favicon.ico"><base href="/blog/"><link rel="preload" href="/blog/_nuxt/e1e7fd08538c67b1e54b.js" as="script"><link rel="preload" href="/blog/_nuxt/2e6fa0dfa1a652457310.js" as="script"><link rel="preload" href="/blog/_nuxt/399649bc2babee5c32c9.js" as="script"><link rel="preload" href="/blog/_nuxt/50dfea6c6acf5aa1b1df.js" as="script"><link rel="preload" href="/blog/_nuxt/4e7a0c964bc2f2022009.js" as="script"><style data-vue-ssr-id="3191d5ad:0 48331b64:0 6bdae85e:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.hljs{display:block;overflow-x:auto;padding:.5em;background:#282828}.hljs,.hljs-subst{color:#ebdbb2}.hljs-deletion,.hljs-formula,.hljs-keyword,.hljs-link,.hljs-selector-tag{color:#fb4934}.hljs-built_in,.hljs-emphasis,.hljs-name,.hljs-quote,.hljs-strong,.hljs-title,.hljs-variable{color:#83a598}.hljs-attr,.hljs-params,.hljs-template-tag,.hljs-type{color:#fabd2f}.hljs-builtin-name,.hljs-doctag,.hljs-literal,.hljs-number{color:#8f3f71}.hljs-code,.hljs-meta,.hljs-regexp,.hljs-selector-id,.hljs-template-variable{color:#fe8019}.hljs-addition,.hljs-meta-string,.hljs-section,.hljs-selector-attr,.hljs-selector-class,.hljs-string,.hljs-symbol{color:#b8bb26}.hljs-attribute,.hljs-bullet,.hljs-class,.hljs-function,.hljs-function .hljs-keyword,.hljs-meta-keyword,.hljs-selector-pseudo,.hljs-tag{color:#8ec07c}.hljs-comment{color:#928374}.hljs-link_label,.hljs-literal,.hljs-number{color:#d3869b}.hljs-comment,.hljs-emphasis{font-style:italic}.hljs-section,.hljs-strong,.hljs-tag{font-weight:700}@media screen and (orientation:portrait){:root{--font-size:3.5vw;--landscape:none;--portrait:block}}@media screen and (orientation:landscape){:root{--font-size:1.5vw;--landscape:block;--portrait:none}}body,html{margin:0;padding:0;overflow-x:hidden;font-family:"PT Serif",Ubuntu Mono,Bungee Shade,monospace,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;font-size:var(--font-size);word-break:break-all;background:#a9a9a9}body,h1,h2,h3,h4,html{color:#000}a{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.title{text-align:center;font-family:Bungee Inline;color:#fff;line-height:12vh}.title span{margin-right:-.5vw;-webkit-animation:bakemono 10s ease-in-out infinite;animation:bakemono 10s ease-in-out infinite}.title span:first-of-type{-webkit-animation-delay:0s;animation-delay:0s}.title span:nth-of-type(2){-webkit-animation-delay:.1s;animation-delay:.1s}.title span:nth-of-type(3){-webkit-animation-delay:.25s;animation-delay:.25s}.title span:nth-of-type(4){-webkit-animation-delay:.45s;animation-delay:.45s}.title span:nth-of-type(5){-webkit-animation-delay:.7s;animation-delay:.7s}.title span:nth-of-type(6){-webkit-animation-delay:1s;animation-delay:1s}.title span:nth-of-type(7){-webkit-animation-delay:1.35s;animation-delay:1.35s}.title span:nth-of-type(8){-webkit-animation-delay:1.75s;animation-delay:1.75s}.title span:nth-of-type(9){-webkit-animation-delay:2.2s;animation-delay:2.2s}.title span:nth-of-type(10){-webkit-animation-delay:2.7s;animation-delay:2.7s}@-webkit-keyframes bakemono{0%{font-family:Bungee Inline}to{font-family:Bungee Shade}}@keyframes bakemono{0%{font-family:Bungee Inline}to{font-family:Bungee Shade}}.black-head{width:100vw;height:20vh;background:linear-gradient(-45deg,#000,#2f4f4f,#000);margin:0;color:snow}.star{color:gold;position:fixed;top:7vh}.small-icon{font-size:calc(var(--font-size)*1);width:calc(var(--font-size)*1);height:calc(var(--font-size)*1)}.icon{font-size:calc(var(--font-size)*1.5);width:calc(var(--font-size)*1.5);height:calc(var(--font-size)*1.5);transform:translateY(10%)}.foot{width:100vw;height:15vh;background:#000;text-align:center;padding-top:3vh;bottom:0}.midashi{-webkit-animation:slidein 1s ease-in-out forwards;animation:slidein 1s ease-in-out forwards}@-webkit-keyframes slidein{0%{margin-left:-1vw;opacity:0}to{margin-left:0;opacity:1}}@keyframes slidein{0%{margin-left:-1vw;opacity:0}to{margin-left:0;opacity:1}}main h1,main h2{margin-top:calc(var(--font-size)*2);border-bottom:5px solid;text-align:center}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div><div class="black-head"><h1 class="title"><span>Z</span> <span>O</span> <span>D</span> <span>I</span> <span>A</span> <span>C</span> <span style="margin-left:var(--font-size)">B</span> <span>L</span> <span>O</span> <span>G</span></h1> <h4 style="line-height:1vh;color:snow;text-align:center;font-weight:700">~ 技術的な防備録 ~</h4></div> <div style="padding:1vw 1vw 1vw 2vw;color:#000;background:#e6e6fa;box-shadow:5px 5px 0 0 #d3d3d3;margin:0 5vw 0 5vw"><a onmouseover='this.style.color="red"' onmouseout='this.style.color="black"' style="color:#000;font-weight:700"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="igloo" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="small-icon svg-inline--fa fa-igloo fa-w-18"><path fill="currentColor" d="M320 33.9c-10.5-1.2-21.2-1.9-32-1.9-99.8 0-187.8 50.8-239.4 128H320V33.9zM96 192H30.3C11.1 230.6 0 274 0 320h96V192zM352 39.4V160h175.4C487.2 99.9 424.8 55.9 352 39.4zM480 320h96c0-46-11.1-89.4-30.3-128H480v128zm-64 64v96h128c17.7 0 32-14.3 32-32v-96H411.5c2.6 10.3 4.5 20.9 4.5 32zm32-192H128v128h49.8c22.2-38.1 63-64 110.2-64s88 25.9 110.2 64H448V192zM0 448c0 17.7 14.3 32 32 32h128v-96c0-11.1 1.9-21.7 4.5-32H0v96zm288-160c-53 0-96 43-96 96v96h192v-96c0-53-43-96-96-96z"></path></svg> BlogのHome
    </a> <b style="margin-left:1vw;margin-right:1vw">></b> <b></b></div> <main style="padding:5vw"><h3 style="box-shadow:5px 5px 0 0 #2f4f4f;background:#006400;color:#fff;padding:2vw;text-align:center"><b class="midashi" style="border-bottom:dotted 3px #dc143c">
                AWS ALB のメンテナンス閉塞をShellスクリプト化した
                <svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="aws" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon svg-inline--fa fa-aws fa-w-20" style="color:#ff8c00"><path fill="currentColor" d="M180.41 203.01c-.72 22.65 10.6 32.68 10.88 39.05a8.164 8.164 0 0 1-4.1 6.27l-12.8 8.96a10.66 10.66 0 0 1-5.63 1.92c-.43-.02-8.19 1.83-20.48-25.61a78.608 78.608 0 0 1-62.61 29.45c-16.28.89-60.4-9.24-58.13-56.21-1.59-38.28 34.06-62.06 70.93-60.05 7.1.02 21.6.37 46.99 6.27v-15.62c2.69-26.46-14.7-46.99-44.81-43.91-2.4.01-19.4-.5-45.84 10.11-7.36 3.38-8.3 2.82-10.75 2.82-7.41 0-4.36-21.48-2.94-24.2 5.21-6.4 35.86-18.35 65.94-18.18a76.857 76.857 0 0 1 55.69 17.28 70.285 70.285 0 0 1 17.67 52.36l-.01 69.29zM93.99 235.4c32.43-.47 46.16-19.97 49.29-30.47 2.46-10.05 2.05-16.41 2.05-27.4-9.67-2.32-23.59-4.85-39.56-4.87-15.15-1.14-42.82 5.63-41.74 32.26-1.24 16.79 11.12 31.4 29.96 30.48zm170.92 23.05c-7.86.72-11.52-4.86-12.68-10.37l-49.8-164.65c-.97-2.78-1.61-5.65-1.92-8.58a4.61 4.61 0 0 1 3.86-5.25c.24-.04-2.13 0 22.25 0 8.78-.88 11.64 6.03 12.55 10.37l35.72 140.83 33.16-140.83c.53-3.22 2.94-11.07 12.8-10.24h17.16c2.17-.18 11.11-.5 12.68 10.37l33.42 142.63L420.98 80.1c.48-2.18 2.72-11.37 12.68-10.37h19.72c.85-.13 6.15-.81 5.25 8.58-.43 1.85 3.41-10.66-52.75 169.9-1.15 5.51-4.82 11.09-12.68 10.37h-18.69c-10.94 1.15-12.51-9.66-12.68-10.75L328.67 110.7l-32.78 136.99c-.16 1.09-1.73 11.9-12.68 10.75h-18.3zm273.48 5.63c-5.88.01-33.92-.3-57.36-12.29a12.802 12.802 0 0 1-7.81-11.91v-10.75c0-8.45 6.2-6.9 8.83-5.89 10.04 4.06 16.48 7.14 28.81 9.6 36.65 7.53 52.77-2.3 56.72-4.48 13.15-7.81 14.19-25.68 5.25-34.95-10.48-8.79-15.48-9.12-53.13-21-4.64-1.29-43.7-13.61-43.79-52.36-.61-28.24 25.05-56.18 69.52-55.95 12.67-.01 46.43 4.13 55.57 15.62 1.35 2.09 2.02 4.55 1.92 7.04v10.11c0 4.44-1.62 6.66-4.87 6.66-7.71-.86-21.39-11.17-49.16-10.75-6.89-.36-39.89.91-38.41 24.97-.43 18.96 26.61 26.07 29.7 26.89 36.46 10.97 48.65 12.79 63.12 29.58 17.14 22.25 7.9 48.3 4.35 55.44-19.08 37.49-68.42 34.44-69.26 34.42zm40.2 104.86c-70.03 51.72-171.69 79.25-258.49 79.25A469.127 469.127 0 0 1 2.83 327.46c-6.53-5.89-.77-13.96 7.17-9.47a637.37 637.37 0 0 0 316.88 84.12 630.22 630.22 0 0 0 241.59-49.55c11.78-5 21.77 7.8 10.12 16.38zm29.19-33.29c-8.96-11.52-59.28-5.38-81.81-2.69-6.79.77-7.94-5.12-1.79-9.47 40.07-28.17 105.88-20.1 113.44-10.63 7.55 9.47-2.05 75.41-39.56 106.91-5.76 4.87-11.27 2.3-8.71-4.1 8.44-21.25 27.39-68.49 18.43-80.02z"></path></svg></b></h3> <div style="box-shadow:5px 5px 0 0 wheat;background:#fff;padding:5vw"></div></main> <footer class="foot"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" onmouseover='this.style.color="darkorange"' onmouseout='this.style.color="gold"' onclick='location.href="https://twitter.com/zodiac_G12"' class="icon svg-inline--fa fa-twitter-square fa-w-14" style="color:gold;margin:0 .1vw 0 .1vw"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-48.9 158.8c.2 2.8.2 5.7.2 8.5 0 86.7-66 186.6-186.6 186.6-37.2 0-71.7-10.8-100.7-29.4 5.3.6 10.4.8 15.8.8 30.7 0 58.9-10.4 81.4-28-28.8-.6-53-19.5-61.3-45.5 10.1 1.5 19.2 1.5 29.6-1.2-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3a65.447 65.447 0 0 1-29.2-54.6c0-12.2 3.2-23.4 8.9-33.1 32.3 39.8 80.8 65.8 135.2 68.6-9.3-44.5 24-80.6 64-80.6 18.9 0 35.9 7.9 47.9 20.7 14.8-2.8 29-8.3 41.6-15.8-4.9 15.2-15.2 28-28.8 36.1 13.2-1.4 26-5.1 37.8-10.2-8.9 13.1-20.1 24.7-32.9 34z"></path></svg> <svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" onmouseover='this.style.color="darkorange"' onmouseout='this.style.color="gold"' onclick='location.href="https://github.com/zodiac-G12"' class="icon svg-inline--fa fa-github-square fa-w-14" style="color:gold;margin:0 .1vw 0 .1vw"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg> <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="h-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" onmouseover='this.style.color="darkorange"' onmouseout='this.style.color="gold"' onclick='location.href="https://zodiac-G12.github.io/homepage"' class="icon svg-inline--fa fa-h-square fa-w-14" style="color:gold;margin:0 .1vw 0 .1vw"><path fill="currentColor" d="M448 80v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h352c26.51 0 48 21.49 48 48zm-112 48h-32c-8.837 0-16 7.163-16 16v80H160v-80c0-8.837-7.163-16-16-16h-32c-8.837 0-16 7.163-16 16v224c0 8.837 7.163 16 16 16h32c8.837 0 16-7.163 16-16v-80h128v80c0 8.837 7.163 16 16 16h32c8.837 0 16-7.163 16-16V144c0-8.837-7.163-16-16-16z"></path></svg> <p style="color:snow;font-weight:700">© ZODIAC-G12 2019</p></footer></div></div></div></div><script>window.__NUXT__={layout:"default",data:[{}],error:null,serverRendered:!0}</script><script src="/blog/_nuxt/e1e7fd08538c67b1e54b.js" defer></script><script src="/blog/_nuxt/4e7a0c964bc2f2022009.js" defer></script><script src="/blog/_nuxt/2e6fa0dfa1a652457310.js" defer></script><script src="/blog/_nuxt/399649bc2babee5c32c9.js" defer></script><script src="/blog/_nuxt/50dfea6c6acf5aa1b1df.js" defer></script>
  </body>
</html>
