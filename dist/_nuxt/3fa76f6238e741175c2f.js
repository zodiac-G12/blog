(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{366:function(t,n,e){"use strict";var o=e(238),l=e.n(o),r={data:function(){return{now:l()().tz("Asia/Tokyo").format("ll")}}},c=e(25),component=Object(c.a)(r,(function(){var t=this.$createElement,n=this._self._c||t;return n("footer",{staticClass:"foot"},[n("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"gold"},attrs:{onmouseover:"this.style.color='darkorange'",onmouseout:"this.style.color='gold'",onclick:"location.href='https://twitter.com/zodiac_G12'",icon:["fab","twitter-square"]}}),this._v(" "),n("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"gold"},attrs:{onmouseover:"this.style.color='darkorange'",onmouseout:"this.style.color='gold'",onclick:"location.href='https://github.com/zodiac-G12'",icon:["fab","github-square"]}}),this._v(" "),n("p",{staticStyle:{color:"snow"}},[this._v("© ZODIAC-G12 "+this._s(this.now))])],1)}),[],!1,null,null,null);n.a=component.exports},367:function(t,n,e){"use strict";var o=e(25),component=Object(o.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"black-head"},[n("h1",{staticClass:"title",staticStyle:{"line-height":"15vh"}},[this._v("ZODIAC BLOG")]),this._v(" "),n("h4",{staticStyle:{"line-height":"1vh",color:"snow"}},[this._v("~ 技術的な防備録 ~")])])}],!1,null,null,null);n.a=component.exports},368:function(t,n,e){var map={"./af":239,"./af.js":239,"./ar":240,"./ar-dz":241,"./ar-dz.js":241,"./ar-kw":242,"./ar-kw.js":242,"./ar-ly":243,"./ar-ly.js":243,"./ar-ma":244,"./ar-ma.js":244,"./ar-sa":245,"./ar-sa.js":245,"./ar-tn":246,"./ar-tn.js":246,"./ar.js":240,"./az":247,"./az.js":247,"./be":248,"./be.js":248,"./bg":249,"./bg.js":249,"./bm":250,"./bm.js":250,"./bn":251,"./bn.js":251,"./bo":252,"./bo.js":252,"./br":253,"./br.js":253,"./bs":254,"./bs.js":254,"./ca":255,"./ca.js":255,"./cs":256,"./cs.js":256,"./cv":257,"./cv.js":257,"./cy":258,"./cy.js":258,"./da":259,"./da.js":259,"./de":260,"./de-at":261,"./de-at.js":261,"./de-ch":262,"./de-ch.js":262,"./de.js":260,"./dv":263,"./dv.js":263,"./el":264,"./el.js":264,"./en-SG":265,"./en-SG.js":265,"./en-au":266,"./en-au.js":266,"./en-ca":267,"./en-ca.js":267,"./en-gb":268,"./en-gb.js":268,"./en-ie":269,"./en-ie.js":269,"./en-il":270,"./en-il.js":270,"./en-nz":271,"./en-nz.js":271,"./eo":272,"./eo.js":272,"./es":273,"./es-do":274,"./es-do.js":274,"./es-us":275,"./es-us.js":275,"./es.js":273,"./et":276,"./et.js":276,"./eu":277,"./eu.js":277,"./fa":278,"./fa.js":278,"./fi":279,"./fi.js":279,"./fo":280,"./fo.js":280,"./fr":281,"./fr-ca":282,"./fr-ca.js":282,"./fr-ch":283,"./fr-ch.js":283,"./fr.js":281,"./fy":284,"./fy.js":284,"./ga":285,"./ga.js":285,"./gd":286,"./gd.js":286,"./gl":287,"./gl.js":287,"./gom-latn":288,"./gom-latn.js":288,"./gu":289,"./gu.js":289,"./he":290,"./he.js":290,"./hi":291,"./hi.js":291,"./hr":292,"./hr.js":292,"./hu":293,"./hu.js":293,"./hy-am":294,"./hy-am.js":294,"./id":295,"./id.js":295,"./is":296,"./is.js":296,"./it":297,"./it-ch":298,"./it-ch.js":298,"./it.js":297,"./ja":299,"./ja.js":299,"./jv":300,"./jv.js":300,"./ka":301,"./ka.js":301,"./kk":302,"./kk.js":302,"./km":303,"./km.js":303,"./kn":304,"./kn.js":304,"./ko":305,"./ko.js":305,"./ku":306,"./ku.js":306,"./ky":307,"./ky.js":307,"./lb":308,"./lb.js":308,"./lo":309,"./lo.js":309,"./lt":310,"./lt.js":310,"./lv":311,"./lv.js":311,"./me":312,"./me.js":312,"./mi":313,"./mi.js":313,"./mk":314,"./mk.js":314,"./ml":315,"./ml.js":315,"./mn":316,"./mn.js":316,"./mr":317,"./mr.js":317,"./ms":318,"./ms-my":319,"./ms-my.js":319,"./ms.js":318,"./mt":320,"./mt.js":320,"./my":321,"./my.js":321,"./nb":322,"./nb.js":322,"./ne":323,"./ne.js":323,"./nl":324,"./nl-be":325,"./nl-be.js":325,"./nl.js":324,"./nn":326,"./nn.js":326,"./pa-in":327,"./pa-in.js":327,"./pl":328,"./pl.js":328,"./pt":329,"./pt-br":330,"./pt-br.js":330,"./pt.js":329,"./ro":331,"./ro.js":331,"./ru":332,"./ru.js":332,"./sd":333,"./sd.js":333,"./se":334,"./se.js":334,"./si":335,"./si.js":335,"./sk":336,"./sk.js":336,"./sl":337,"./sl.js":337,"./sq":338,"./sq.js":338,"./sr":339,"./sr-cyrl":340,"./sr-cyrl.js":340,"./sr.js":339,"./ss":341,"./ss.js":341,"./sv":342,"./sv.js":342,"./sw":343,"./sw.js":343,"./ta":344,"./ta.js":344,"./te":345,"./te.js":345,"./tet":346,"./tet.js":346,"./tg":347,"./tg.js":347,"./th":348,"./th.js":348,"./tl-ph":349,"./tl-ph.js":349,"./tlh":350,"./tlh.js":350,"./tr":351,"./tr.js":351,"./tzl":352,"./tzl.js":352,"./tzm":353,"./tzm-latn":354,"./tzm-latn.js":354,"./tzm.js":353,"./ug-cn":355,"./ug-cn.js":355,"./uk":356,"./uk.js":356,"./ur":357,"./ur.js":357,"./uz":358,"./uz-latn":359,"./uz-latn.js":359,"./uz.js":358,"./vi":360,"./vi.js":360,"./x-pseudo":361,"./x-pseudo.js":361,"./yo":362,"./yo.js":362,"./zh-cn":363,"./zh-cn.js":363,"./zh-hk":364,"./zh-hk.js":364,"./zh-tw":365,"./zh-tw.js":365};function o(t){var n=l(t);return e(n)}function l(t){if(!e.o(map,t)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return map[t]}o.keys=function(){return Object.keys(map)},o.resolve=l,t.exports=o,o.id=368},370:function(t,n,e){"use strict";e(101),e(141);var o={data:function(){return{pre:null,dir:null}},mounted:function(){this.pre=location.href.split("blog")[0]+"blog/",this.dir=" > "+location.href.replace(this.pre,"")}},l=e(25),component=Object(l.a)(o,(function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticStyle:{padding:"1vw",width:"100vw",color:"black",background:"seagreen"}},[n("a",{staticStyle:{color:"black"},attrs:{onmouseover:"this.style.color='maroon'",onmouseout:"this.style.color='black'",href:this.pre}},[n("font-awesome-icon",{staticClass:"small-icon",attrs:{icon:["fas","igloo"]}}),this._v(" Home")],1),this._v(this._s(this.dir)+"\n")])}),[],!1,null,null,null);n.a=component.exports},564:function(t,n,e){"use strict";e.r(n);var o=e(238),l=e.n(o),r=e(367),c=e(366),j=e(370),h=e(374),d=e.n(h),m=e(561),f=e.n(m),_={data:function(){return{now:l()().tz("Asia/Tokyo").format("ll"),heisokuview:null,heisoku:'\n```sh\n####################################################################\n#\n#    メンテナンス開始のshellスクリプト(4つルールができる)\n#\n####################################################################\n\n\n# AWS ALBのリスナーのARNのjsonファイル名\njson="aws_alb_listener_dev_arn.json"\nmaintenance_statusCode=503\n\n# リスナーのARN\nlistener_one=$( cat $json | jq \'.[]\' | jq \'.[0]\' | jq -r \'.[]\' )\nlistener_two=$( cat $json | jq \'.[]\' | jq \'.[1]\' | jq -r \'.[]\' )\n\n\n############################# API v* 直下にアクセスされたときのJSON レスポンス(×2) #############################\n\n# 出力されたjsonをtmp.jsonとして一時保存\naws elbv2 create-rule \\\n    --listener-arn $listener_one \\\n    --conditions Field=path-pattern,Values="/api/v*" \\\n    --priority 1 \\\n    --actions Type=fixed-response,FixedResponseConfig=\n    \\{"MessageBody=\n    \'\\{\\"id\\":-5000,\n    \\"description\\":\\"ただいまメンテナンス中です。しばらくお待ちください\\"\\}\',\n    StatusCode=$maintenance_statusCode,ContentType=application/json"\\} | tee tmp.json\n\n# ルールのARNを抽出(1個目)\nrule_three=$( cat tmp.json | jq \'.Rules[0].RuleArn\' )\n\naws elbv2 create-rule \\\n    --listener-arn $listener_two \\\n    --conditions Field=path-pattern,Values="api/v*" \\\n    --priority 1 \\\n    --actions Type=fixed-response,FixedResponseConfig=\n    \\{"MessageBody=\n    \'\\{\\"id\\":-5000,\n    \\"description\\":\\"ただいまメンテナンス中です。しばらくお待ちください\\"\\}\'\n    ,StatusCode=$maintenance_statusCode,ContentType=application/json"\\} | tee tmp.json\n\n# ルールのARNを抽出(2個目)\nrule_four=$( cat tmp.json | jq \'.Rules[0].RuleArn\' )\n\n\n############################# API v* 直下以外の任意のパスにアクセスされたときのHTML レスポンス(×2) #############################\n\naws elbv2 create-rule \\\n    --listener-arn $listener_one \\\n    --conditions Field=path-pattern,Values="*" \\\n    --priority 2 \\\n    --actions Type=fixed-response,FixedResponseConfig=\n    \\{"MessageBody=\n    <body><p>ただいまメンテナンス中です。しばらくお待ちください</p></body>\n    ,StatusCode=$maintenance_statusCode,ContentType=text/html"\\} | tee tmp.json\n\n# ルールのARNを抽出(3個目)\nrule_one=$( cat tmp.json | jq \'.Rules[0].RuleArn\' )\n\naws elbv2 create-rule \\\n    --listener-arn $listener_two \\\n    --conditions Field=path-pattern,Values="*" \\\n    --priority 2 \\\n    --actions Type=fixed-response,FixedResponseConfig=\n    \\{"MessageBody=\n    <body><p>ただいまメンテナンス中です。しばらくお待ちください</p></body>,\n    StatusCode=$maintenance_statusCode,ContentType=text/html"\\} | tee tmp.json\n\n# ルールのARNを抽出(4個目)\nrule_two=$( cat tmp.json | jq \'.Rules[0].RuleArn\' )\n\n\n# ルールのARNを変数に代入したらいらないので消す\nrm tmp.json\n\n# ルールのARNの保存形式\nrule_arn_json="\\{\n    \\"development_alb_rule_arns\\": [\n        \\{\\"rule_one\\": $rule_one\\},\n        \\{\\"rule_two\\": $rule_two\\},\n        \\{\\"rule_three\\": $rule_three\\},\n        \\{\\"rule_four\\": $rule_four\\}\n    ]\n\\}"\n\n# ルールのARNのjsonを新規作成する\necho $rule_arn_json | tee aws_alb_rule_dev_arn.json\n\necho maintenance start.\n\n```\n            '}},created:function(){f.a.setOptions({langPrefix:"",highlight:function(code,t){return d.a.highlightAuto(code,[t]).value}})},mounted:function(){d.a.initHighlightingOnLoad(),this.heisokuview=f()(this.heisoku)},components:{defaultFooter:c.a,defaultHeader:r.a,pankuz:j.a}},v=(e(562),e(25)),component=Object(v.a)(_,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("default-header"),t._v(" "),e("pankuz"),t._v(" "),e("main",{staticStyle:{margin:"2vw",color:"black"}},[e("h3",[t._v("\n            AWS ALB のメンテナンス閉塞をShellスクリプト化した\n        "),e("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"#fd7e14"},attrs:{icon:["fab","aws"]}})],1),t._v(" "),e("a-divider",{staticStyle:{background:"black"},attrs:{type:"horizontal"}}),t._v(" "),e("b",[e("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"midnightblue"},attrs:{icon:["fab","linux"]}}),t._v(" \n                ＜ AWS ALB ってなんですか？\n        ")],1),t._v(" "),e("p",{staticStyle:{"margin-top":"5vh"}},[e("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"#fd7e14"},attrs:{icon:["fab","angular"]}}),t._v(" \n            ＜"),e("a",{attrs:{href:"https://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/introduction.html"}},[t._v("\n                https://docs.aws.amazon.com/ja_jp/elasticloadbalancing/latest/application/introduction.html\n            ")])],1),t._v(" "),e("b",{staticStyle:{"margin-top":"5vh"}},[e("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"midnightblue"},attrs:{icon:["fab","linux"]}}),t._v(" \n                ＜ なぜシェルスクリプト化したんですか？\n        ")],1),t._v(" "),e("p",{staticStyle:{"margin-top":"5vh"}},[e("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"#fd7e14"},attrs:{icon:["fab","angular"]}}),t._v(" \n            ＜ 教える筋合いないです。仮にそんな方には説明してもわからないと思います。\n        ")],1),t._v(" "),e("h3",[t._v("\n            いきなりコード\n            "),e("font-awesome-icon",{staticClass:"icon",staticStyle:{color:"#fd7e14"},attrs:{icon:["fas","bath"]}})],1),t._v(" "),e("a-divider",{staticStyle:{background:"black"},attrs:{type:"horizontal"}}),t._v(" "),e("pre",{domProps:{innerHTML:t._s(t.heisokuview)}}),t._v(" "),e("b",[t._v("本当にごめんなさい。今度詳細記事書きます。")])],1),t._v(" "),e("default-footer")],1)}),[],!1,null,null,null);n.default=component.exports}}]);